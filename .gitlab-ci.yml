image:
  name: docker/compose:1.23.2
  entrypoint: [""]

variables:
  DB_PASSWORD: dbcuttest
  DB_NAME: dbcuttest
  DB_USER: dbcuttest
  POSTGRES_DB: $DB_NAME
  POSTGRES_USER: $DB_USER
  POSTGRES_PASSWORD: $DB_PASSWORD
  MYSQL_DATABASE: $DB_NAME
  MYSQL_ROOT_PASSWORD: $DB_PASSWORD


services:
- name: mysql:latest
  alias: testmysql_with_data
- name: mysql:latest
  alias: testmysql_without_data
- name: postgres:latest
  alias: testpostgres_without_data


connect:
  image: testmysql_with_data
  script:
  - echo "SELECT 'OK';" | mysql --user=root --password="$MYSQL_ROOT_PASSWORD" --host=mysql "$MYSQL_DATABASE"

# before_script:
#   - docker version
#   - docker-compose version

# stages:
#   - build
#   - test

# build:
#   stage: build
#   script:
#     - docker-compose build

# test:
#   stage: test
#   script:
#     - docker-compose run --rm dbcut_app

